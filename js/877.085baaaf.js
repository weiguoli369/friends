"use strict";(self["webpackChunkfriends"]=self["webpackChunkfriends"]||[]).push([[877],{4877:function(e,t,s){s.r(t),s.d(t,{default:function(){return k}});s(7658);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"search-container"},[t("form",{attrs:{action:"/"}},[t("van-search",{attrs:{"show-action":"",placeholder:"请输入搜索关键词"},on:{search:e.onSearch,cancel:function(t){return e.$router.push("/friends")}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),t("van-tabs",{on:{click:e.onClick}},[0==this.list.length?t("van-tab",{attrs:{title:"请输入要搜索的内容"}}):e._l(e.speakerlist,(function(s){return t("van-tab",{key:s[0],attrs:{title:s[0]}},[t("van-badge",{attrs:{slot:"title",content:s[1]},slot:"title"},[e._v(e._s(s[0]))]),e._l(e.filterList,(function(e,s){return t("search-item",{key:s,attrs:{item:e}})}))],2)}))],2)],1)},i=[],r=(s(541),function(){var e=this,t=e._self._c;return t("div",{staticClass:"searchResult-container"},[t("van-cell",[t("van-button",{attrs:{type:"primary",size:"mini",round:""}},[e._v(e._s(e.item.Order))]),t("van-button",{attrs:{type:"info",size:"mini",round:""}},[e._v(e._s(e.item.Speaker))]),t("van-button",{attrs:{type:"warning",size:"mini",round:""}},[e._v("Line:"+e._s(e.item.LineNumber))]),t("span",{staticClass:"content",domProps:{innerHTML:e._s(e.item.Content)}})],1)],1)}),a=[],l={name:"SearchResult",components:{},data(){return{}},computed:{},watch:{},props:{item:{type:Object,require:!0}},methods:{},created(){}},o=l,c=s(1001),h=(0,c.Z)(o,r,a,!1,null,"28b2472d",null),u=h.exports,p=s(3718),d={name:"SearchView",components:{SearchItem:u},data(){return{value:"",list:[],speakerlist:[],selected:"全部"}},computed:{filterList:function(){return"全部"===this.selected||0==this.list.length?this.list:this.list.filter((e=>e.Speaker===this.selected))}},watch:{},props:{},methods:{onClick(e,t){console.log(e),this.selected=t},onSearch(e){this.list=[],this.speakerlist=[],this.selected="全部";const t=new Map;for(let s=0;s<p.length;s++){let n="S"+p[s].no_scene+"E"+p[s].no_ep;for(let i=0;i<p[s].lines.length;i++){let r=p[s].lines[i].content;if(r.length>0&&-1!=r.search(new RegExp(e,"i"))){let a=r.replace(new RegExp(e,"igm"),'<span style="color:red;vertical-align: bottom;font-weight:bold;">'+e+"</span>");p[s].lines[i].speaker&&(this.list.push({Order:n,Speaker:p[s].lines[i].speaker,Content:a,LineNumber:p[s].lines[i].line_number}),t.has(p[s].lines[i].speaker)?t.set(p[s].lines[i].speaker,t.get(p[s].lines[i].speaker)+1):t.set(p[s].lines[i].speaker,1))}}}0!=this.list.length?(this.speakerlist=Array.from(t),this.speakerlist.unshift(["全部",this.list.length]),this.speakerlist.sort(((e,t)=>t[1]-e[1]))):this.$toast("当前台词不存在")}},created(){}},f=d,m=(0,c.Z)(f,n,i,!1,null,"683e85f2",null),k=m.exports}}]);
//# sourceMappingURL=877.085baaaf.js.map